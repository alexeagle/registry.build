<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Twirl Template Rules for Bazel</h1><a id="user-content-twirl-template-rules-for-bazel" class="anchor" aria-label="Permalink: Twirl Template Rules for Bazel" href="#twirl-template-rules-for-bazel"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Status</th>
<th>Stardoc</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/lucidsoftware/rules_twirl/actions"><img src="https://github.com/lucidsoftware/rules_twirl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a></td>
<td><a href="docs/stardoc/twirl.md">Stardoc</a></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Overview</h2><a id="user-content-overview" class="anchor" aria-label="Permalink: Overview" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>rules_twirl</code> compiles <a href="https://github.com/playframework/twirl">Twirl</a> templates to <a href="http://www.scala-lang.org/" rel="nofollow">Scala</a>, so they can be used with <a href="https://github.com/bazelbuild/rules_scala"><code>bazelbuild/rules_scala</code></a> and <a href="https://github.com/higherkindness/rules_scala"><code>higherkindness/rules_scala</code></a>.</p>
<p dir="auto">Simple Core API: <a href="docs/stardoc/twirl.md">twirl_templates</a></p>
<p dir="auto">For more information about Twirl templates, see <a href="https://www.playframework.com/documentation/latest/ScalaTemplates#the-template-engine" rel="nofollow">the Play Twirl documentation</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Installation</h2><a id="user-content-installation" class="anchor" aria-label="Permalink: Installation" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Create a file called at the top of your repository named <code>WORKSPACE</code> and add the following snippet to it.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# update version as needed
rules_twirl_version = &quot;TODO&quot;
http_archive(
    name = &quot;rules_twirl&quot;,
    sha256 = &quot;TODO&quot;,
    strip_prefix = &quot;rules_twirl-{}&quot;.format(rules_twirl_version),
    type = &quot;zip&quot;,
    url = &quot;https://github.com/lucidsoftware/rules_twirl/archive/{}.zip&quot;.format(rules_twirl_version),
)

# rules_jvm_external
rules_jvm_external_version = &quot;6.2&quot;

http_archive(
    name = &quot;rules_jvm_external&quot;,
    sha256 = &quot;aa39ecd47e16d5870eba817fe71476802bc371fe2724a2ddee565992df55f4af&quot;,
    strip_prefix = &quot;rules_jvm_external-{}&quot;.format(rules_jvm_external_version),
    type = &quot;zip&quot;,
    url = &quot;https://github.com/bazelbuild/rules_jvm_external/archive/{}.zip&quot;.format(rules_jvm_external_version),
)

load(&quot;@rules_jvm_external//:repositories.bzl&quot;, &quot;rules_jvm_external_deps&quot;)
rules_jvm_external_deps()

load(&quot;@rules_jvm_external//:setup.bzl&quot;, &quot;rules_jvm_external_setup&quot;)
rules_jvm_external_setup()

load(
    &quot;@rules_twirl//:workspace.bzl&quot;,
    &quot;twirl_compiler_cli_2_13_repositories&quot;,
    &quot;twirl_compiler_cli_3_repositories&quot;,
)
twirl_compiler_cli_3_repositories()
load(&quot;@twirl_compiler_cli_3//:defs.bzl&quot;, twirl_compiler_cli_3_pinned_maven_install = &quot;pinned_maven_install&quot;)
twirl_compiler_cli_3_pinned_maven_install()

twirl_compiler_cli_2_13_repositories()
load(&quot;@twirl_compiler_cli_2_13//:defs.bzl&quot;, twirl_compiler_cli_2_13_pinned_maven_install = &quot;pinned_maven_install&quot;)
twirl_compiler_cli_2_13_pinned_maven_install()

# Twirl compiler
load(&quot;@rules_twirl//twirl-toolchain:register-toolchains.bzl&quot;, &quot;twirl_register_toolchains&quot;)
twirl_register_toolchains(default_toolchain_name = &quot;twirl-3&quot;)"><pre><span class="pl-c"># update version as needed</span>
<span class="pl-s1">rules_twirl_version</span> <span class="pl-c1">=</span> <span class="pl-s">"TODO"</span>
<span class="pl-en">http_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_twirl"</span>,
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-s">"TODO"</span>,
    <span class="pl-s1">strip_prefix</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_twirl-{}"</span>.<span class="pl-en">format</span>(<span class="pl-s1">rules_twirl_version</span>),
    <span class="pl-s1">type</span> <span class="pl-c1">=</span> <span class="pl-s">"zip"</span>,
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">"https://github.com/lucidsoftware/rules_twirl/archive/{}.zip"</span>.<span class="pl-en">format</span>(<span class="pl-s1">rules_twirl_version</span>),
)

<span class="pl-c"># rules_jvm_external</span>
<span class="pl-s1">rules_jvm_external_version</span> <span class="pl-c1">=</span> <span class="pl-s">"6.2"</span>

<span class="pl-en">http_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_jvm_external"</span>,
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-s">"aa39ecd47e16d5870eba817fe71476802bc371fe2724a2ddee565992df55f4af"</span>,
    <span class="pl-s1">strip_prefix</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_jvm_external-{}"</span>.<span class="pl-en">format</span>(<span class="pl-s1">rules_jvm_external_version</span>),
    <span class="pl-s1">type</span> <span class="pl-c1">=</span> <span class="pl-s">"zip"</span>,
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">"https://github.com/bazelbuild/rules_jvm_external/archive/{}.zip"</span>.<span class="pl-en">format</span>(<span class="pl-s1">rules_jvm_external_version</span>),
)

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:repositories.bzl"</span>, <span class="pl-s">"rules_jvm_external_deps"</span>)
<span class="pl-en">rules_jvm_external_deps</span>()

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:setup.bzl"</span>, <span class="pl-s">"rules_jvm_external_setup"</span>)
<span class="pl-en">rules_jvm_external_setup</span>()

<span class="pl-en">load</span>(
    <span class="pl-s">"@rules_twirl//:workspace.bzl"</span>,
    <span class="pl-s">"twirl_compiler_cli_2_13_repositories"</span>,
    <span class="pl-s">"twirl_compiler_cli_3_repositories"</span>,
)
<span class="pl-en">twirl_compiler_cli_3_repositories</span>()
<span class="pl-en">load</span>(<span class="pl-s">"@twirl_compiler_cli_3//:defs.bzl"</span>, <span class="pl-s1">twirl_compiler_cli_3_pinned_maven_install</span> <span class="pl-c1">=</span> <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">twirl_compiler_cli_3_pinned_maven_install</span>()

<span class="pl-en">twirl_compiler_cli_2_13_repositories</span>()
<span class="pl-en">load</span>(<span class="pl-s">"@twirl_compiler_cli_2_13//:defs.bzl"</span>, <span class="pl-s1">twirl_compiler_cli_2_13_pinned_maven_install</span> <span class="pl-c1">=</span> <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">twirl_compiler_cli_2_13_pinned_maven_install</span>()

<span class="pl-c"># Twirl compiler</span>
<span class="pl-en">load</span>(<span class="pl-s">"@rules_twirl//twirl-toolchain:register-toolchains.bzl"</span>, <span class="pl-s">"twirl_register_toolchains"</span>)
<span class="pl-en">twirl_register_toolchains</span>(<span class="pl-s1">default_toolchain_name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-3"</span>)</pre></div>
<p dir="auto">This installs <code>rules_twirl</code> to your <code>WORKSPACE</code> and sets up toolchains for a Scala 2.13 and Scala 3 version of the Twirl compiler with Scala 3 being the default. To change the default to Scala 2.13, set <code>default_toolchain_name = "twirl-2-13"</code></p>
<p dir="auto">If you want to use a custom Twirl compiler, you can set up a custom toolchain in a BUILD.bazel file as follows:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_twirl//twirl-toolchain:create-toolchain.bzl&quot;, &quot;create_twirl_toolchain&quot;)

create_twirl_toolchain(
    name = &quot;twirl-custom&quot;,
    twirl_compiler = &quot;&lt;label of your custom Twirl templates compiler&gt;&quot;,
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_twirl//twirl-toolchain:create-toolchain.bzl"</span>, <span class="pl-s">"create_twirl_toolchain"</span>)

<span class="pl-en">create_twirl_toolchain</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-custom"</span>,
    <span class="pl-s1">twirl_compiler</span> <span class="pl-c1">=</span> <span class="pl-s">"&lt;label of your custom Twirl templates compiler&gt;"</span>,
)</pre></div>
<p dir="auto">Then change the <code>twirl_register_toolchains</code> in the <code>WORKSPACE</code> file to use your custom toolchain:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="twirl_register_toolchains(
    default_toolchain_name = &quot;twirl-custom&quot;,
    toolchains = [&quot;&lt;label of your custom Twirl templates compiler&gt;&quot;]
)"><pre><span class="pl-en">twirl_register_toolchains</span>(
    <span class="pl-s1">default_toolchain_name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-custom"</span>,
    <span class="pl-s1">toolchains</span> <span class="pl-c1">=</span> [<span class="pl-s">"&lt;label of your custom Twirl templates compiler&gt;"</span>]
)</pre></div>
<p dir="auto">You can find the available versions of the Twirl Compiler CLI on maven: <a href="https://mvnrepository.com/artifact/com.lucidchart/twirl-compiler-cli" rel="nofollow">https://mvnrepository.com/artifact/com.lucidchart/twirl-compiler-cli</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The <code>twirl_templates</code> rule compiles Twirl templates to a source jar that can be used with the <code>rules_scala</code> rules. For example,</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="twirl_templates(
    name = &quot;twirl-templates&quot;,
    source_directory = &quot;app&quot;,
    srcs = glob([&quot;app/**/*.scala.html&quot;])
        + glob([&quot;app/**/*.scala.xml&quot;])
        + glob([&quot;app/**/*.scala.js&quot;])
        + glob([&quot;app/**/*.scala.txt&quot;]),
)

scala_binary(
    name = &quot;foo-service&quot;,
    srcs = glob([&quot;app/**/*.scala&quot;]) + [&quot;:twirl-templates&quot;],
    main_class = &quot;foo.server.RunServer&quot;,
    deps = [...],
)"><pre><span class="pl-en">twirl_templates</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-templates"</span>,
    <span class="pl-s1">source_directory</span> <span class="pl-c1">=</span> <span class="pl-s">"app"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.html"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.xml"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.js"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.txt"</span>]),
)

<span class="pl-en">scala_binary</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"foo-service"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala"</span>]) <span class="pl-c1">+</span> [<span class="pl-s">":twirl-templates"</span>],
    <span class="pl-s1">main_class</span> <span class="pl-c1">=</span> <span class="pl-s">"foo.server.RunServer"</span>,
    <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [...],
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Overriding the default Twirl compiler</h3><a id="user-content-overriding-the-default-twirl-compiler" class="anchor" aria-label="Permalink: Overriding the default Twirl compiler" href="#overriding-the-default-twirl-compiler"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To override the default Twirl compiler for a single target, you can change the <code>twirl_toolchain_name</code> attribute on the <code>twirl_routes</code> target. That attribute can be set to the name of any <code>twirl_toolchain</code> registered with <code>twirl_register_toolchains</code> (and created using <code>create_twirl_toolchain</code>). By default <code>twirl-3</code> and <code>twirl-2-13</code> are valid values.</p>
<p dir="auto">For example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="twirl_templates(
    name = &quot;twirl-templates&quot;,
    source_directory = &quot;app&quot;,
    srcs = glob([&quot;app/**/*.scala.html&quot;])
        + glob([&quot;app/**/*.scala.xml&quot;])
        + glob([&quot;app/**/*.scala.js&quot;])
        + glob([&quot;app/**/*.scala.txt&quot;]),
    twirl_toolchain_name = &quot;twirl-2-13&quot;,
)"><pre><span class="pl-en">twirl_templates</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-templates"</span>,
    <span class="pl-s1">source_directory</span> <span class="pl-c1">=</span> <span class="pl-s">"app"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.html"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.xml"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.js"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.txt"</span>]),
    <span class="pl-s1">twirl_toolchain_name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-2-13"</span>,
)</pre></div>
<p dir="auto">See the <a href="docs/stardoc/twirl.md">Stardoc documentation</a> for the full list of options for <code>twirl_templates</code>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Use with the Play Framework</h3><a id="user-content-use-with-the-play-framework" class="anchor" aria-label="Permalink: Use with the Play Framework" href="#use-with-the-play-framework"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>twirl_templates</code> can be used with the <a href="https://github.com/lucidsoftware/rules_play_routes"><code>rules_play_routes</code></a> to run a Play Framework Service. For example</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="twirl_templates(
    name = &quot;twirl-templates&quot;,
    source_directory = &quot;app&quot;,
    include_play_imports = True,
    srcs = glob([&quot;app/**/*.scala.html&quot;])
        + glob([&quot;app/**/*.scala.xml&quot;])
        + glob([&quot;app/**/*.scala.js&quot;])
        + glob([&quot;app/**/*.scala.txt&quot;]),
    additional_imports = [...],
)

play_routes(
    name = &quot;play-routes&quot;,
    srcs = [&quot;conf/routes&quot;] + glob([&quot;conf/*.routes&quot;]),
    include_play_imports = True,
    generate_reverse_router = True,
    routes_imports = [...],
)

scala_binary(
    name = &quot;foo-service&quot;,
    srcs = glob([&quot;app/**/*.scala&quot;])  + [&quot;:twirl-templates&quot;, &quot;:play-routes&quot;],
    visibility = [&quot;//visibility:public&quot;],
    main_class = &quot;play.core.server.ProdServerStart&quot;,
    resources = [&quot;conf/logback.xml&quot;] + glob([&quot;conf/resources/**/*&quot;]),
    resource_strip_prefix = native.package_name(),
    classpath_resources = [&quot;conf/application.conf&quot;],
    jvm_flags = [
    	  &quot;-Dhttp.port=9000&quot;,
    	  &quot;-Dapplication.name=foo-service&quot;,
    ],
    deps = [...],
)"><pre><span class="pl-en">twirl_templates</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"twirl-templates"</span>,
    <span class="pl-s1">source_directory</span> <span class="pl-c1">=</span> <span class="pl-s">"app"</span>,
    <span class="pl-s1">include_play_imports</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.html"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.xml"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.js"</span>])
        <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala.txt"</span>]),
    <span class="pl-s1">additional_imports</span> <span class="pl-c1">=</span> [...],
)

<span class="pl-en">play_routes</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"play-routes"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> [<span class="pl-s">"conf/routes"</span>] <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"conf/*.routes"</span>]),
    <span class="pl-s1">include_play_imports</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>,
    <span class="pl-s1">generate_reverse_router</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>,
    <span class="pl-s1">routes_imports</span> <span class="pl-c1">=</span> [...],
)

<span class="pl-en">scala_binary</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"foo-service"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"app/**/*.scala"</span>])  <span class="pl-c1">+</span> [<span class="pl-s">":twirl-templates"</span>, <span class="pl-s">":play-routes"</span>],
    <span class="pl-s1">visibility</span> <span class="pl-c1">=</span> [<span class="pl-s">"//visibility:public"</span>],
    <span class="pl-s1">main_class</span> <span class="pl-c1">=</span> <span class="pl-s">"play.core.server.ProdServerStart"</span>,
    <span class="pl-s1">resources</span> <span class="pl-c1">=</span> [<span class="pl-s">"conf/logback.xml"</span>] <span class="pl-c1">+</span> <span class="pl-en">glob</span>([<span class="pl-s">"conf/resources/**/*"</span>]),
    <span class="pl-s1">resource_strip_prefix</span> <span class="pl-c1">=</span> <span class="pl-s1">native</span>.<span class="pl-en">package_name</span>(),
    <span class="pl-s1">classpath_resources</span> <span class="pl-c1">=</span> [<span class="pl-s">"conf/application.conf"</span>],
    <span class="pl-s1">jvm_flags</span> <span class="pl-c1">=</span> [
    	  <span class="pl-s">"-Dhttp.port=9000"</span>,
    	  <span class="pl-s">"-Dapplication.name=foo-service"</span>,
    ],
    <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [...],
)</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Development</h2><a id="user-content-development" class="anchor" aria-label="Permalink: Development" href="#development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Command Line Twirl Compiler</h3><a id="user-content-command-line-twirl-compiler" class="anchor" aria-label="Permalink: Command Line Twirl Compiler" href="#command-line-twirl-compiler"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This project consists of the Twirl Bazel rules and a command line Twirl compiler. The command line compiler can be built with</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel build //twirl-compiler"><pre>bazel build //twirl-compiler</pre></div>
<p dir="auto">It can be run with</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run //twirl-compiler"><pre>bazel run //twirl-compiler</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Testing</h3><a id="user-content-testing" class="anchor" aria-label="Permalink: Testing" href="#testing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">All tests can be run using</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="test/run_all_tests.sh"><pre>test/run_all_tests.sh</pre></div>
<p dir="auto">They can also be run using</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel test //test/..."><pre>bazel <span class="pl-c1">test</span> //test/...</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Updating Third Party Dependencies</h3><a id="user-content-updating-third-party-dependencies" class="anchor" aria-label="Permalink: Updating Third Party Dependencies" href="#updating-third-party-dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">We use <a href="https://github.com/bazelbuild/rules_jvm_external">rules_jvm_external</a> to import third party dependencies.</p>
<p dir="auto">To make changes to the dependencies, simply update <code>maven_install</code> in the appropriate <code>workspace.bzl</code> file (<code>workspace.bzl</code> for the main <code>rules_twirl</code> implementation or <code>test_workspace.bzl</code> for the tests), and then update the dependencies json file used by <code>rules_jvm_external</code> by running the following script:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="scripts/gen-deps.sh"><pre>scripts/gen-deps.sh</pre></div>
<p dir="auto">Never modify the dependencies json file directly.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Updating Stardoc</h3><a id="user-content-updating-stardoc" class="anchor" aria-label="Permalink: Updating Stardoc" href="#updating-stardoc"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Before pushing your changes, make sure you update the documentation by running the following script:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="scripts/gen-docs.sh"><pre>scripts/gen-docs.sh</pre></div>
<p dir="auto">Failure to do so will result in CI failing.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Releasing</h2><a id="user-content-releasing" class="anchor" aria-label="Permalink: Releasing" href="#releasing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To release a new version to Maven Central:</p>
<ol dir="auto">
<li>Push a tag with this syntax: <code>P1.P2.P3</code> where <code>P1.P2.P3</code> is the Twirl version, e.g., <code>2.0.7</code></li>
<li>Once the build completes (including the publish step), find the <a href="https://oss.sonatype.org/#stagingRepositories" rel="nofollow">staging repo in Sonatype</a> (assuming you're signed in and have access to the project)</li>
<li>Verify all the artifacts are on the staging Repository, and then close it through the Sonatype GUI</li>
<li>Once Sonatype's pre-release checks on the repository complete, release it through the Sonatype GUI</li>
<li>Verify the artifact's present in <a href="https://search.maven.org/search?q=com.lucidchart" rel="nofollow">Maven Central</a> (it can take multiple hours for everything to sync)</li>
</ol>
</article></div>