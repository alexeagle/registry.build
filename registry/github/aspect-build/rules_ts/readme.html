<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-bazel-rules-for-typescript" class="anchor" aria-hidden="true" href="#bazel-rules-for-typescript"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Bazel rules for TypeScript</h1>
<p dir="auto">This is the canonical ruleset for using Bazel for TypeScript, based on
<a href="https://github.com/aspect-build/rules_js">https://github.com/aspect-build/rules_js</a>, and recommended for all new projects.</p>
<p dir="auto">Many companies are successfully building with rules_ts. If you're getting value from the project, please let us know! Just comment on our <a href="https://github.com/aspect-build/rules_js/discussions/1000" data-hovercard-type="discussion" data-hovercard-url="/aspect-build/rules_js/discussions/1000/hovercard">Adoption Discussion</a>.</p>
<p dir="auto">This is a high-performance alternative to the <code>@bazel/typescript</code> npm package from rules_nodejs.
The <code>ts_project</code> rule here is identical to the one in rules_nodejs, making it easy to migrate.
Since rules_js always runs tools from the bazel-out tree, rules_ts naturally fixes most usability bugs with rules_nodejs:</p>
<ul dir="auto">
<li>Freely mix generated <code>*.ts</code> and <code>tsconfig.json</code> files in the bazel-out tree with source files</li>
<li>Fixes the need for any <code>rootDirs</code> settings in <code>tsconfig.json</code> as reported in <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="580388985" data-permission-text="Title is private" data-url="https://github.com/microsoft/TypeScript/issues/37378" data-hovercard-type="issue" data-hovercard-url="/microsoft/TypeScript/issues/37378/hovercard" href="https://github.com/microsoft/TypeScript/issues/37378">microsoft/TypeScript#37378</a></li>
<li>"worker mode" for <code>ts_project</code> now shares workers across all targets, rather than requiring one worker pool per target</li>
</ul>
<p dir="auto">rules_ts is just a part of what Aspect provides:</p>
<ul dir="auto">
<li><em>Need help?</em> This ruleset has support provided by <a href="https://aspect.dev" rel="nofollow">https://aspect.dev</a>.</li>
<li>See our other Bazel rules, especially those built for rules_js, linked from <a href="https://github.com/aspect-build">https://github.com/aspect-build</a></li>
</ul>
<p dir="auto">Known issues:</p>
<ul dir="auto">
<li>Does not work with <code>--worker_sandboxing</code>. See <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1338149928" data-permission-text="Title is private" data-url="https://github.com/aspect-build/rules_ts/issues/127" data-hovercard-type="issue" data-hovercard-url="/aspect-build/rules_ts/issues/127/hovercard?comment_id=1312041592&amp;comment_type=issue_comment" href="https://github.com/aspect-build/rules_ts/issues/127#issuecomment-1312041592">#127 (comment)</a></li>
<li>Workers are disabled and not currently supported on Windows hosts. See <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1436476219" data-permission-text="Title is private" data-url="https://github.com/aspect-build/rules_ts/issues/228" data-hovercard-type="issue" data-hovercard-url="/aspect-build/rules_ts/issues/228/hovercard" href="https://github.com/aspect-build/rules_ts/issues/228">#228</a>.</li>
</ul>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">From the release you wish to use:
<a href="https://github.com/aspect-build/rules_ts/releases">https://github.com/aspect-build/rules_ts/releases</a>
copy the WORKSPACE snippet into your <code>WORKSPACE</code> file.</p>
<h2 dir="auto"><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h2>
<p dir="auto">There are a number of examples in <a href="https://github.com/aspect-build/rules_ts/tree/main/examples">the examples/ folder</a> and
larger examples in the <a href="https://github.com/aspect-build/bazel-examples">bazel-examples repository</a> using rules_ts such as
<a href="https://github.com/aspect-build/bazel-examples/tree/main/jest">jest</a>, <a href="https://github.com/aspect-build/bazel-examples/tree/main/react-cra">react</a>,
<a href="https://github.com/aspect-build/bazel-examples/tree/main/angular">angular</a>.</p>
<p dir="auto">If you'd like an example added, you can file a <a href="https://github.com/aspect-build/rules_ts/issues/new/choose">Feature Request</a>.</p>
<h2 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h2>
<p dir="auto">See the API documentation in <a href="https://github.com/aspect-build/rules_ts/tree/main/docs">the docs/ folder</a>.</p>
<h3 dir="auto"><a id="user-content-from-a-build-file" class="anchor" aria-hidden="true" href="#from-a-build-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>From a BUILD file</h3>
<p dir="auto">The most common use is with the <a href="./docs/rules.md#ts_project"><code>ts_project</code> macro</a> which invokes the
<a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" rel="nofollow"><code>tsc</code> CLI</a> to transform
source files like <code>.ts</code> files into outputs such as <code>.js</code> and <code>.d.ts</code> files.</p>
<p dir="auto">We encourage you to read about the <code>transpiler</code> property which lets you use a faster tool like
Babel or SWC to produce the <code>.js</code> files, so you don't have to wait for type-checking in your fast
development loop.</p>
<h3 dir="auto"><a id="user-content-in-a-macro" class="anchor" aria-hidden="true" href="#in-a-macro"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>In a macro</h3>
<p dir="auto">Many organizations set default values, so it's common to write a <a href="https://bazel.build/extending/macros" rel="nofollow">macro</a> to wrap <code>ts_project</code>, then
ensure that your developers load your macro rather than loading from <code>@aspect_rules_ts</code> directly.</p>
<h3 dir="auto"><a id="user-content-build-file-generation" class="anchor" aria-hidden="true" href="#build-file-generation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>BUILD file generation</h3>
<p dir="auto">Aspect provides an alpha preview of our TypeScript BUILD file generator as part of the
<a href="https://aspect.build/cli" rel="nofollow">Aspect CLI</a>. Run <code>aspect configure</code> to create or update BUILD.bazel files
as you edit TypeScript sources.</p>
<h3 dir="auto"><a id="user-content-advanced-custom-rules" class="anchor" aria-hidden="true" href="#advanced-custom-rules"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Advanced: custom rules</h3>
<p dir="auto">If you know how to write Bazel rules, you might find that <code>ts_project</code> doesn't do what you want.</p>
<p dir="auto">One way to customize it is to peel off one layer of indirection, by calling the <code>ts_project_rule</code>
directly. This bypasses our default setting logic, and also the validation program which checks that
ts_project attributes are well-formed.</p>
<p dir="auto">You can also write a custom rule from scratch. We expose helper functions from /ts/private in this
repo. Be aware that these are not a public API, so you may have to account for breaking changes
which aren't subject to our usual semver policy.</p>
</article></div>